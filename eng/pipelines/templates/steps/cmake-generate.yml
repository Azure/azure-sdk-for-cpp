parameters:
  CmakeGeneratePath: ''
  Env: ''
  GenerateArgs: ''

steps:
  - pwsh: Write-Host "Downloading and extracting Cosmos DB Emulator - ${{ parameters.Env }} "
    workingDirectory: ${{ parameters.CmakeGeneratePath }}
    displayName: ENVs

  - script: mkdir build
    workingDirectory: ${{ parameters.CmakeGeneratePath }}
    displayName: create working directory

  - script: pwd
    workingDirectory: ${{ parameters.CmakeGeneratePath }}/build
    displayName: Show current path

  - script: ${{ parameters.Env }} cmake ${{ parameters.GenerateArgs }} ..
    workingDirectory: ${{ parameters.CmakeGeneratePath }}/build
    displayName: cmake generate

  - script: rm -rf build
    workingDirectory: ${{ parameters.CmakeGeneratePath }}
    displayName: clean build folder
