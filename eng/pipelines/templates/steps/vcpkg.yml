steps:
  - pwsh: |
      Write-Host "##vso[task.setvariable variable=VCPKG_BINARY_SOURCES_SECRET;issecret=true;]clear;x-azblob,https://cppvcpkgcache.blob.core.windows.net/public-vcpkg-container,,read"
      Write-Host "##vso[task.setvariable variable=X_VCPKG_ASSET_SOURCES_SECRET;issecret=true;]clear;x-azurl,https://cppvcpkgcache.blob.core.windows.net/public-vcpkg-asset-container/,,read"
    displayName: Set Vcpkg Variables

  - task: AzurePowerShell@5
    displayName: Set Vcpkg Write-mode Cache
    condition: and(succeeded(), eq(variables['System.TeamProject'], 'internal'))
    inputs:
      azureSubscription: 'cpp Resource Group'
      ScriptType: FilePath
      ScriptPath: eng/scripts/Set-VcpkgWriteModeCache.ps1
      azurePowerShellVersion: LatestVersion
      pwsh: true
